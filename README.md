# torch-opencv-chess

## Description

这个项目是想要通过 opencv 来获取棋盘的图像，然后通过 torch 来训练一个模型来识别棋子的位置，最后生成一个棋盘的图像。

> TODO: 实现一个简单的下棋 AI

## Thinking

1. 通过 opencv 来获取棋盘的图像，然后通过霍夫圆变换来获取棋子的位置，截取棋子的图像
2. 对棋子的图像进行各种变换，如旋转，改变明亮度，对比度等，生成训练数据
3. 用生成的训练数据来训练一个模型，用来识别棋子的种类
4. 最后根据棋子的种类和位置来生成一个棋盘的图像

## Details

### Global_Params

- `Chess_pieces`是由对图像`chess.jpg`进行霍夫圆检测得到的圆的顺序决定的，来保证生成的图像都能被放到正确的位置

### chess_crop.py

- `chess_crop`是用来截取棋子的图像的，通过霍夫圆检测来获取棋子的位置，然后截取棋子的图像
- 再对棋子的图像进行各种变换，如旋转，改变明亮度，对比度等，生成训练数据，保存到相应的文件夹中

### train.py

- 首先利用`glob`来获取所有的训练数据，然后通过`torchvision`来加载数据
- 将数据分为训练集和测试集，然后通过 CNN 来训练一个模型，其中该 CNN 架构基于`cifar10`模型做了一些小改动
- 最后将模型保存到`model.pth`中

### chessboard.py

- 加载训练好的模型，然后根据棋子的种类和位置来生成一个棋盘的图像
  （但是，由于某些未知因素，对于棋子种类的识别并不是很准确，所以没有继续写下去）

## Declaration

- 由于作者水平有限，所以可能有很多不足之处，欢迎大家指正